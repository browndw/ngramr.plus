---
title: "Introduction to the ngramr.plus R package"
author: "David Brown"
output: rmarkdown::html_vignette
bibliography: ngramr_bib.bib
link-citations: yes
nocite: |
  @*
vignette: >
  %\VignetteIndexEntry{introduction}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
options(rmarkdown.html_vignette.check_title = FALSE)
```

## Load the ngramr.plus package

Load the package, as well as others that we'll use in this vignette.

```{r setup, message = FALSE, error=FALSE}
library(ngramr.plus)
library(tidyverse)
```

**Note**: The examples in this vignette use pre-computed data to ensure fast building and reproducibility. To run the actual `google_ngram()` function with live data from Google Books, you'll need an internet connection and should expect longer processing times (several minutes) depending on the word frequency and corpus size.

## Retrieving data

Running the functions is straightforward, but remember that it can take a couple minutes if you are loading one of the larger Google Books data tables. Here we show how to return counts of *zinger* by year from the data tables for US English.

```{r xray_year, eval=FALSE}
# This example downloads data from Google Books (requires internet connection)
z_year <- google_ngram(word_forms = "zinger", variety = "us", by = "year")
```

For this vignette, we'll use pre-computed example data to demonstrate the output format:

```{r create_example_data, echo=FALSE}
# Create example data that mimics the structure returned by google_ngram()
z_year <- data.frame(
  Year = c(1950, 1955, 1960, 1965, 1970, 1975, 1980, 1985, 1990, 1995, 2000, 2005),
  AF = c(5, 12, 45, 89, 156, 234, 312, 398, 445, 523, 601, 687),
  Total = c(1234567, 1456789, 1678901, 1891234, 2103456, 2315678, 2527890, 2740123, 2952345, 3164567, 3376789, 3589012),
  Per_10.6 = c(4.05, 8.23, 26.81, 47.06, 74.14, 101.08, 123.46, 145.23, 150.78, 165.24, 177.94, 191.45)
)
```

Check the data:

```{r echo=FALSE}
knitr::kable(head(z_year))
```

In current usage, *zinger* denotes a kind of cutting quip. Its [supposed origin](https://www.etymonline.com/word/zinger) is as a baseball term that becomes generalized in the middle of the 20th century. Does this explanation comport with the data?

## Plot the data

To partly answer such a question, we can plot the data:

```{r year_plot, fig.height=4.5, fig.width=7}
  ggplot(z_year %>% filter(Year > 1799), aes(x=Year, y=Per_10.6)) +
    geom_point(size = .5) +
    geom_smooth(method = "gam", formula = y ~ s(x, bs = "cs"), linewidth=.25) +
    labs(x="year", y = "frequency (per million words)")+ 
    theme(panel.grid.minor.x=element_blank(),
          panel.grid.major.x=element_blank()) +
    theme(panel.grid.minor.y =   element_blank(),
          panel.grid.major.y =   element_line(colour = "gray", linewidth=0.25)) +
    theme(rect = element_blank()) +
    theme(legend.title=element_blank()) +
    theme(axis.title = element_text(color="#666666", face="bold", size=10))
```

There does appear to be some circulation prior to the mid-20th century. To explain that, we can look at [the underlying texts in Google Books](https://www.google.com/search?q=%22zinger%22&tbm=bks&tbs=cdr:1,cd_min:1800,cd_max:1893&lr=lang_en).

## By decade

Next, we'll show how to return counts of *zinger* and *zingers* by decade from the data tables for British English.

```{r xray_decade, eval=FALSE}
# This example downloads data from Google Books (requires internet connection)
z_decade <- google_ngram(word_forms = c("zinger", "zingers"), variety = "gb", by = "decade")
```

Again, we'll use example data to demonstrate the output:

```{r create_decade_data, echo=FALSE}
# Create example decade data
z_decade <- data.frame(
  Decade = c(1950, 1960, 1970, 1980, 1990, 2000),
  AF = c(23, 87, 234, 456, 678, 891),
  Total = c(12345678, 15678901, 18901234, 21234567, 23567890, 25890123),
  Per_10.6 = c(1.86, 5.55, 12.38, 21.47, 28.76, 34.42)
)
```

Check the data:

```{r echo=FALSE}
knitr::kable(head(z_decade))
```

## Ploting the data

Now we can filter and plot our by-decade data:

```{r decade_plot, fig.height=4.5, fig.width=7}
ggplot(z_decade %>% filter(Decade > 1799), aes(x=Decade, y=Per_10.6)) +
  geom_bar(stat = "identity") +
  labs(x="decade", y = "frequency (per million words)")+ 
  theme(panel.grid.minor.x=element_blank(),
         panel.grid.major.x=element_blank()) +
  theme(panel.grid.minor.y =   element_blank(),
        panel.grid.major.y =   element_line(colour = "gray", linewidth=0.25)) +
  theme(rect = element_blank()) +
  theme(legend.title=element_blank()) +
  theme(axis.title = element_text(color="#666666", face="bold", size=10))
```


## Bibliography


